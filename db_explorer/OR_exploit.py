#order reviews analysis/visualization

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

caminho_arquivo_reviews = './csv/olist_order_reviews_dataset.csv'

try:
    df_reviews = pd.read_csv(caminho_arquivo_reviews)

    print("--- Análise da distribuição da coluna 'review_score' ---\n")
    
    contagem_notas = df_reviews['review_score'].value_counts().sort_index()
    
    print("Contagem de reviews por nota:")
    print(contagem_notas)
    
    print("\nContagem em porcentagem:")
    print(df_reviews['review_score'].value_counts(normalize=True).sort_index() * 100)
    
    #Visualização
    plt.figure(figsize=(10, 6))
    sns.countplot(x='review_score', data=df_reviews, order=[1, 2, 3, 4, 5])
    plt.title('Distribuição das Notas de Review')
    plt.xlabel('Nota da Review')
    plt.ylabel('Quantidade de Avaliações')
    plt.savefig('./img/distribuicao_notas.png')

except FileNotFoundError:
    print(f"ERRO: Arquivo não encontrado em '{caminho_arquivo_reviews}'")
    print("Verifique se o nome do arquivo e o caminho estão corretos.")